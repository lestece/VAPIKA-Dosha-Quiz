<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Quiz to discover your Ayurvedic Dosha" />
    <meta name="keywords" content="quiz, dosha, ayurveda, prakruti, holistic" />
    <meta name="author" content="Celeste Loi" />

    <link rel="stylesheet" href="assets/css/styles.css" />
    <!-- Mandala created by Icongeek26 - Flaticon; this commented out code is just for the purpose of attribution: 
         <a href="https://www.flaticon.com/free-icons/mandala" title="mandala icons">Mandala icons created by Icongeek26 - Flaticon</a>
         Icon has been converted to the .ico format https://www.icoconverter.com/ -->
    <link rel="icon" href="assets/images/mandala.ico" type="image/icon type">
    <title>VAPIKA Dosha Quiz</title>
</head>

<body>
    <!-- Header containing logo -->
    <header>
        <a href="index.html">
            <img src="assets/images/vapika-logo.png" alt="vapika logo" id="logo" /></a>
    </header>

    <main>
        <div class="container sign-up-container">
            <form method="" action="" class="signup-form" id="signup-form">
                <h1 id="sign-up-heading">Thank you for completing the quiz!</h1>
                <p id="sign-up-p">
                    Before being redirected to your result, please sign up to our
                    newsletter to receive monthly tips and recommendations specifically
                    tailored to your Dosha.
                </p>
                <input type="text" id="user-name" name="user-name" required class="text-input"
                    placeholder="Your name" />
                <input type="email" id="email" name="email_address" required class="text-input"
                    placeholder="Your email address" />
                <textarea id="feedback" name="feedback" rows="4" cols="50"
                    placeholder="leave us a feedback..."></textarea>
                <button class="btn" id="signup-btn" onclick='sendMail()'>Sign up</button>
            </form>
            <button class="btn" id="results-btn">
                Skip and go to your quiz result
            </button>
        </div>
    </main>

    <!-- Footer containing social media buttons -->
    <footer>
        <div class="social-container">
            <a href="https://www.facebook.com/" target="_blank" rel="noopener"
                aria-label="Visit our Facebook page (opens in a new tab)">
                <i class="fab fa-facebook-f"></i></a>
            <a href="https://www.instagram.com/" target="_blank" rel="noopener"
                aria-label="Visit our Instagram page (opens in a new tab)"><i class="fab fa-instagram"></i></a>
            <a href="https://twitter.com/" target="_blank" rel="noopener"
                aria-label="Visit our Twitter page (opens in a new tab)"><i class="fab fa-twitter"></i></a>
            <a href="https://tiktok.com/" target="_blank" rel="noopener"
                aria-label="Visit our Twitter page (opens in a new tab)"><i class="fab fa-tiktok"></i></a>
        </div>
    </footer>

    <!-- fontawesome script for social media icons -->
    <script src="https://kit.fontawesome.com/1705e36da1.js" crossorigin="anonymous"></script>
    <!-- sweetAlert scripts for sign up confirmation pop up window -->
    <!-- instructions followed on https://sweetalert2.github.io/#download -->
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="sweetalert2.all.min.js"></script>
    <!-- EmailJS script -->
    <!-- Inspired by the tutorial at https://martinezjf2.medium.com/how-to-setup-emailjs-33809350f0f8 -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js">
    </script>
    <!-- Connect to my EmailJS account using my Public Key -->
    <script>
        (function () {
            emailjs.init("-nc1aZVdy7YoJikvg");
        })();</script>
    <!--Function to call the emailjs.sendForm method -->
    <script>
        function sendMail() {
            document.getElementById('signup-form').addEventListener('submit', function (event) {
                let userName = document.getElementById('user-name').value;
                event.preventDefault();
                //Method provided within the emailJS documentation at https://www.emailjs.com/docs/sdk/send-form/
                emailjs.sendForm('service_6z74g5e', "template_h7twzk8", '#signup-form').then(function () {
                    console.log('SUCCESS');
                    //Get the button element
                    let subscribe = document.getElementById('signup-btn');
                    //Get the sign up form
                    let signupForm = document.getElementById('signup-form');
                    //reset will clear the form
                    signupForm.reset();
                    //If the form is successfully sent, it
                    sessionStorage.setItem('userName', userName);
                    // Sweet Alert sign up confirmation with timer pop up window          
                    let timerInterval
                    Swal.fire({
                        title: 'You have successfully signed up!',
                        html: `Check your Inbox for a confirmation email.
                        You're now being redirected to the results page!`,
                        timer: 4000,
                        timerProgressBar: true,
                        didOpen: () => {
                            Swal.showLoading()
                            const b = Swal.getHtmlContainer().querySelector('b')
                            timerInterval = setInterval(() => {
                                b.textContent = Swal.getTimerLeft()
                            }, 100)
                        },
                        willClose: () => {
                            clearInterval(timerInterval)
                        }
                    }).then((result) => {
                        /* Redirects to results page */
                        if (result.dismiss === Swal.DismissReason.timer) {
                            window.location = "./quiz-results.html";
                        }
                    })
                    //If there's an error, it will log "Failed..." and console log the error
                }, function (error) {
                    console.log('FAILED...', error)
                });
            });
        }
    </script>
    <script>
        //Script for "go to results page" button 
        document.getElementById("results-btn").addEventListener("click", function () {
            window.location = "./quiz-results.html";
        });
    </script>


</body>

</html>